<!DOCTYPE html><html class="has-navbar-fixed-top"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>The ABC of Dart Part 6 - 库类的引用 - Debug表演艺术家</title><meta name="description" content="ViTe&#39;s Blog"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="baidu-site-verification" content="05MX5vANvW"><link rel="stylesheet" href="//cdn.bootcss.com/outdated-browser/1.1.5/outdatedbrowser.min.css"><link rel="icon" href="https://vites.app/images/favicon.png"><script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script><link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet"><link rel="stylesheet" href="//fonts.lug.ustc.edu.cn/css?family=Ovo|Source+Code+Pro"><link rel="stylesheet" href="//cdn.bootcss.com/bulma/0.6.2/css/bulma.min.css"><link rel="stylesheet" href="//cdn.bootcss.com/lightgallery/1.6.10/css/lightgallery.min.css"><link rel="stylesheet" href="//cdn.bootcss.com/justifiedGallery/3.7.0/css/justifiedGallery.min.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous"><script src="//cdn.bootcss.com/moment.js/2.22.1/moment.min.js"></script><script>function setArticleTime(e,t){var d=moment(t),n=moment().diff(d,"days",!0);document.getElementsByClassName(e)[0].innerHTML=7<n?d.format("YYYY年MM月DD日 HH:mm:ss"):d.fromNow()}!function(e,t){"object"==typeof exports&&"undefined"!=typeof module&&"function"==typeof require?t(require("../moment")):"function"==typeof define&&define.amd?define(["../moment"],t):t(e.moment)}(this,function(e){"use strict";return e.defineLocale("zh-cn",{months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日Ah点mm分",LLLL:"YYYY年M月D日ddddAh点mm分",l:"YYYY/M/D",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日dddd HH:mm"},meridiemParse:/凌晨|早上|上午|中午|下午|晚上/,meridiemHour:function(e,t){return 12===e&&(e=0),"凌晨"===t||"早上"===t||"上午"===t?e:"下午"===t||"晚上"===t?e+12:11<=e?e:e+12},meridiem:function(e,t,d){var n=100*e+t;return n<600?"凌晨":n<900?"早上":n<1130?"上午":n<1230?"中午":n<1800?"下午":"晚上"},calendar:{sameDay:"[今天]LT",nextDay:"[明天]LT",nextWeek:"[下]ddddLT",lastDay:"[昨天]LT",lastWeek:"[上]ddddLT",sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}(日|月|周)/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"日";case"M":return e+"月";case"w":case"W":return e+"周";default:return e}},relativeTime:{future:"%s内",past:"%s前",s:"几秒",ss:"%d 秒",m:"1 分钟",mm:"%d 分钟",h:"1 小时",hh:"%d 小时",d:"1 天",dd:"%d 天",M:"1 个月",MM:"%d 个月",y:"1 年",yy:"%d 年"},week:{dow:1,doy:4}})})</script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?40c23cf929965ff7dcc44d0e695ed794";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script></head><body><nav class="navbar is-transparent is-fixed-top navbar-main" role="navigation" aria-label="main navigation"><div class="container"><div class="navbar-brand"> <a class="navbar-item" href="/" style="padding:0 3rem 0 1rem"><img src="/images/logo.png" alt=""></a><div class="navbar-burger"><span></span><span></span><span></span></div></div><div class="navbar-menu navbar-start"> <a class="navbar-item" href="/archives">Archives</a> <a class="navbar-item" href="/categories">Categories</a> <a class="navbar-item" href="/tags">Tags</a> <a class="navbar-item" href="/about">About</a></div><div class="navbar-menu navbar-end"><a class="navbar-item search" href="javascript:;"><i class="fas fa-search"></i></a><div class="navbar-item is-hoverable has-dropdown is-hidden-mobile is-hidden-tablet-only"><a class="navbar-item toc"><i class="fa fa-list"></i></a><div class="navbar-dropdown is-right"> <a class="navbar-item" href="#Pub包管理器">1 Pub包管理器</a><hr class="navbar-divider"> <a class="navbar-item" href="#import">2 import</a> <a class="navbar-item" href="#命名冲突">2.1 命名冲突</a> <a class="navbar-item" href="#部分引用">2.2 部分引用</a><hr class="navbar-divider"> <a class="navbar-item" href="#library">3 library</a><hr class="navbar-divider"> <a class="navbar-item" href="#export">4 export</a></div></div><a class="navbar-item" href="https://github.com/vitess"><i class="fab fa-github"></i></a><a class="navbar-item" href="https://weibo.com/2373803622"><i class="fab fa-weibo"></i></a><a class="navbar-item" href="mailto:vite@outlook.com"><i class="fa fa-envelope-square"></i></a></div></div></nav><section class="section"><div class="container"><article class="article content gallery" itemscope itemprop="blogPost"><h1 class="article-title is-size-3 is-size-4-mobile" itemprop="name"> The ABC of Dart Part 6 - 库类的引用</h1><div class="article-meta columns is-variable is-1 is-multiline is-mobile is-size-7-mobile"><span class="column is-narrow"><time class="article-time-cd32d183" datetime="2018-08-03T03:49:21.000Z" itemprop="datePublished"></time></span><span class="column is-narrow article-category"><i class="far fa-folder"></i> <a class="article-category-link" href="/categories/dev/">开发</a></span></div><div class="article-entry is-size-6-mobile" itemprop="articleBody"><p><code>Dart</code>中除了最基本的类型对象外，还提供了很多不同功能的库或类，比如一些异步操作、IO操作等等，这些都被一一封装到<code>Dart</code>的SDK中，由一个个独立的.dart文件承载着。</p><a id="more"></a><p>举个例子，在<code>Java</code>中，如果要使用某个类的功能，需要先通过<code>import</code>把该类引用进来。同样的，<code>Dart</code>也需要这种操作。</p><blockquote><p>目前我使用的Android Studio 3.1.3，比较不好的一点是写<code>Dart</code>时不能像<code>Java</code>一样自动引用对应的库。</p></blockquote><h1 id="Pub包管理器"><a href="#Pub包管理器" class="headerlink" title="Pub包管理器"></a>Pub包管理器</h1><p>了解库类的引用前，先学习一下<code>Dart</code>中的Pub包管理器。</p><p>Pub有点像Android项目中的Gradle——Gradle管理下的Android项目，我们用<code>build.gradle</code>来管理项目中的引用和其他配置；同样的，<code>Dart</code>也有<code>pubspec.yaml</code>来管理引用。</p><p>一般地，一个<code>Dart</code>项目的根目录下，包含有<code>lib</code>文件夹和<code>pubspec.yaml</code>文件。该文件包含了一个包的元数据，例如包的名称等。所以一个<code>Dart</code>项目也是一个包。</p><p>举个例子，一个最简单的<code>pubspec.yaml</code>内容如下：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">test</span></span><br><span class="line"></span><br><span class="line"><span class="attr">deppendencies:</span></span><br><span class="line"><span class="attr">  cupertino_icons:</span> <span class="string">^0.1.2</span></span><br></pre></td></tr></table></figure><p><code>name</code>表示该包的名称，而<code>deppendencies</code>下的每一项则表示该包的引用。上述内容就表示了一个名叫test的包，这个包引用了一个名为cupertino_icons，版本号为0.1.2的包。</p><p>这里的版本号写法为<code>^0.1.2</code>，表示该版本号的约束为<code>&gt;=0.1.2 &lt;0.2.0</code>，这种写法为<code>Caret</code>语法，关于这点不作详细描述。</p><p>关于更多的有关pub的操作（例如配置项目资源、使用pub的命令行命令等）就不再阐述，此类操作可以等需要用到时再查找。</p><h1 id="import"><a href="#import" class="headerlink" title="import"></a>import</h1><p><code>Dart</code>中的<code>import</code>用法和<code>Java</code>基本相同，不同的是<code>import</code>后缀的引用路径：</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//"dart:"前缀表示Dart的标准库</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'dart:async'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//同文件夹下的dart</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'lib1.dart'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//同路径下的其他文件中的dart</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'lib2/lib2.dart'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//绝对路径</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'../lib3/lib3.dart'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//通过包名+路径</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'package:test/lib1.dart'</span>;</span><br></pre></td></tr></table></figure><p>其中通过包命+路径的引用方式，结合上述的Pub，可知我在本项目中的pubspec.yaml里引用了一个名为<code>test</code>的包，则我可以在项目内的.dart文件里通过前缀<code>package:</code>加上包名+库类在该包内的路径来引用相应的库类。</p><h2 id="命名冲突"><a href="#命名冲突" class="headerlink" title="命名冲突"></a>命名冲突</h2><p>很多时候，我们引用的库类可能存在名称相同的情况，比如：</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'p1/lib1.dart'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'p2/lib2.dart'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//编译器提示异常</span></span><br><span class="line">MyClass myClass = <span class="keyword">new</span> MyClass();</span><br></pre></td></tr></table></figure><p>如上，我在lib1.dart和lib2.dart中都定义了一个名为<code>MyClass</code>的类，当我在引用处使用<code>MyClass</code>时，编译器提示我这个类在lib1.dart和lib2.dart都有定义，因此无法编译。</p><p>针对这种情况，可以使用<code>as</code>关键字，对某个引用声明其命名空间：</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'p1/lib1.dart'</span> <span class="keyword">as</span> lib1;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'p2/lib2.dart'</span> <span class="keyword">as</span> lib2;</span><br><span class="line"></span><br><span class="line">lib1.MyClass myClass1 = <span class="keyword">new</span> lib1.MyClass();</span><br><span class="line">lib2.MyClass myClass2 = <span class="keyword">new</span> lib2.MyClass();</span><br></pre></td></tr></table></figure><p>如上，通过声明不同的命名空间，则可以在调用时通过对应的命名空间即可。</p><h2 id="部分引用"><a href="#部分引用" class="headerlink" title="部分引用"></a>部分引用</h2><p>有时候，我们可能只希望引用一个.dart文件中的某些库类，而不是引用其全部内容，则可以通过关键字<code>show</code>和<code>hide</code>来实现。</p><p>顾名思义，<code>show</code>表示只引用一个文件中的指定类；而<code>hide</code>则表示除指定类外其他类都引用。它们都可以通过逗号指定多个类：</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'p1/lib1.dart'</span> show MyClass1,MyClass2;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'p2/lib2.dart'</span> hide MyClass3;</span><br></pre></td></tr></table></figure><h1 id="library"><a href="#library" class="headerlink" title="library"></a>library</h1><p><code>library</code>关键字可以定义一个.dart文件（即一个库）的名字，但不影响库的引用，因为引用都是通过文件路径。</p><p>之所以要定义名字，是因为这个要配合<code>part</code>、<code>part of</code>关键字来使用。</p><p>例如，当我要维护一个库<code>math</code>，这个库包含项目需要的所有数学方法，比如加减乘除，那么这个库可以通过<code>part</code>来将不同的功能放到不同的.dart文件中，达到将库分散、细化粒度的效果。</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">library</span> math;</span><br><span class="line"></span><br><span class="line"><span class="keyword">part</span> <span class="string">'plus.dart'</span>;</span><br><span class="line"><span class="keyword">part</span> <span class="string">'minus.dart'</span>;</span><br><span class="line"><span class="keyword">part</span> <span class="string">'multiply.dart'</span>;</span><br><span class="line"><span class="keyword">part</span> <span class="string">'divide.part'</span>;</span><br></pre></td></tr></table></figure><p>如上，我可以创建一个<code>math.dart</code>文件，这个文件路径在lib/math文件夹下。<code>math.dart</code>文件内部只有上述内容，因为具体实现功能都分散给各.dart文件来实现。</p><p>相应地，<code>part</code>修饰的各个文件内部，都需要通过<code>part of</code>来声明自身属于哪个库：</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">part</span> of math;</span><br></pre></td></tr></table></figure><p>所以在<code>plus.dart</code>等四个文件中，开头都需要通过上述代码声明自己属于<code>math</code>这个库中。</p><p>关于<code>library</code>、<code>part</code>、<code>part of</code>，可以再看看<code>Dart</code>的SDK，里面的很多库都是通过这种方式实现的。</p><h1 id="export"><a href="#export" class="headerlink" title="export"></a>export</h1><p><code>export</code>的使用方式和<code>import</code>相同，但是意义却不一样。它表示在一个库中导出另一个库，这样当第三个库引用第一个库时，也能引用到第二个库的内容。</p><p>例如，我现在有<code>lib1.dart</code>、<code>lib2.dart</code>、<code>lib3.dart</code>三个文件，其中<code>lib1.dart</code>中的内容为：</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'lib2.dart'</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="string">'lib2.dart'</span>;</span><br></pre></td></tr></table></figure><p>然后在<code>lib3.dart</code>中：</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'lib1.dart'</span>;</span><br></pre></td></tr></table></figure><p>这样，即使<code>lib3.dart</code>中没有导入<code>lib2.dart</code>，也可以用到<code>lib2.dart</code>内的内容。</p><p>关于<code>export</code>的实际应用可以看一下这篇文章：<a href="http://dart.goodev.org/guides/libraries/create-library-packages#organizing-a-library-package" target="_blank" rel="noopener">organizing-a-library-package</a>。</p></div><div class="columns is-variable is-1 is-multiline is-mobile"><span class="column is-narrow"><a class="tag is-light article-tag" href="/tags/Dart/"><i class="fa fa-hashtag" aria-hidden="true" style="padding-right:3px"></i> Dart</a></span></div><div class="columns is-mobile is-multiline article-nav"> <span class="column is-12-mobile is-half-desktop article-nav-prev"><a href="/article/dev/ba35e115.html">The ABC of Dart Part 7 - 异步</a></span> <span class="column is-12-mobile is-half-desktop article-nav-next"><a href="/article/dev/543b8039.html">The ABC of Dart Part 5 - 操作符重载</a></span></div><script>setArticleTime("article-time-cd32d183","Fri Aug 03 2018 11:49:21 GMT+0800")</script></article><div class="sharebox"><div class="addthis_inline_share_toolbox"></div><script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5af91abd06c0d49f"></script></div><div class="comments"><h3 class="title is-4">评论</h3><div id="valine-thread"></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><script>new Valine({el:"#valine-thread",notify:!1,verify:!1,app_id:"GUCbjfNG4dzXp1OK5wLej8sB-gzGzoHsz",app_key:"8g2nRqttkIwqsgHOOsEzRvX2",placeholder:"我有一言，请诸位静听",avatar:"identicon"})</script></div></div></section><footer class="footer"><div class="container"><div class="columns content"><div class="column is-narrow has-text-centered"> &copy; 2020 Vincent Tam&nbsp; Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> & <a href="http://github.com/ppoffice/hexo-theme-minos">Minos</a></div><div class="column is-hidden-mobile"></div></div></div></footer><script src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><div id="outdated"><h6>Your browser is out-of-date!</h6><p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/">Update my browser now</a></p><p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p></div><script src="//cdn.bootcss.com/outdated-browser/1.1.5/outdatedbrowser.min.js"></script><script>$(document).ready(function(){outdatedBrowser({bgColor:"#f25648",color:"#ffffff",lowerThan:"flex"})})</script><script>window.FontAwesomeConfig={searchPseudoElements:!0}</script><script>window.MathJax={chtml:{matchFontHeight:!1},options:{ignoreHtmlClass:"tex2jax_ignore",processHtmlClass:"tex2jax_process"},tex:{autoload:{color:[],colorV2:["color"]},packages:{"[+]":["noerrors"]}},loader:{load:["input/asciimath","[tex]/noerrors"]}}</script><script src="//cdn.bootcss.com/mathjax/3.0.5/es5/tex-mml-chtml.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/lightgallery/1.6.8/js/lightgallery-all.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/justifiedGallery/3.6.5/js/jquery.justifiedGallery.min.js"></script><script>!function(e){e(document).ready(function(){"function"==typeof e.fn.lightGallery&&e(".article.gallery").lightGallery({selector:".gallery-item"}),"function"==typeof e.fn.justifiedGallery&&e(".justified-gallery").justifiedGallery()})}(jQuery)</script><script src="/js/script.js"></script><div class="searchbox ins-search"><div class="searchbox-mask"></div><div class="searchbox-container ins-search-container"><div class="searchbox-input-wrapper"> <input type="text" class="searchbox-input ins-search-input" placeholder="站内搜索"><span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span></div><div class="searchbox-result-wrapper ins-section-wrapper"><div class="ins-section-container"></div></div></div></div><script>window.INSIGHT_CONFIG={TRANSLATION:{POSTS:"文章",PAGES:"页面",CATEGORIES:"分类",TAGS:"标签",UNTITLED:"(无标题)"},CONTENT_URL:"/content.json"}</script><script src="/js/insight.js"></script></body></html>